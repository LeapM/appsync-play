(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{106:function(n,e){},209:function(n,e,t){n.exports=t(713)},214:function(n,e,t){},215:function(n,e,t){},713:function(n,e,t){"use strict";t.r(e);var r=t(14),i=t.n(r),o=t(194),c=t.n(o),s=(t(214),t(215),t(207)),u=t(208),a=t(195),l=t(196),b=t(107),v=t.n(b),p=t(197),d=t(108),h=t.n(d),f=t(204),m="ap-southeast-2",g="https://q3ckq5u6dvds7b3pxdtswxzjii.appsync-api.ap-southeast-2.amazonaws.com/graphql",w="ap-southeast-2",k=null,E=function(){var n=Object(p.a)(v.a.mark(function n(){return v.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!k){n.next=2;break}return n.abrupt("return",k);case 2:return k=new h.a({url:g,region:m,auth:{type:d.AUTH_TYPE.AWS_IAM,credentials:new f.CognitoIdentityCredentials({IdentityPoolId:"ap-southeast-2:43d98a1a-65ef-496d-ba6d-ca788632a755"},{region:w})}}),n.abrupt("return",k);case 4:case"end":return n.stop()}},n)}));return function(){return n.apply(this,arguments)}}(),y=t(205),O=t.n(y),D="subscription OnEventDomainChange($eventDomain: String) {\n  onEventDomainChange(eventDomain: $eventDomain) {\n    id\n    eventDomain\n    eventType\n    sequence\n    eventId\n    eventKey\n    version\n    origin\n    producer\n    producerVersion\n    emitterId\n    emitterTimestamp\n    consumerTimestamp\n    created\n    data\n  }\n}\n",I=t(206),S=function(){function n(e){Object(a.a)(this,n),this.nativeObservable=void 0,this.subscriptions=[],this.creator=void 0,this.creator=e,this.nativeObservable=e()}return Object(l.a)(n,[{key:"resubscribe",value:function(){var n=this;console.log("call resubcript"),this.nativeObservable=this.creator(),this.subscriptions.forEach(function(e){return n.buildSubscription(e.observer)})}},{key:"decorateObserverWithErrorHandler",value:function(n){var e=this;return Object(u.a)({},n,{error:function(t){console.error("error happend with network"),"disconnect"===t?e.resubscribe():n.error&&n.error(t)}})}},{key:"subscribe",value:function(n,e,t){var r=n instanceof Function?{next:n,error:e,complete:t}:n,i=this.buildSubscription(r);return this.subscriptions.push({subscription:i,children:[],observer:r}),console.log(this.subscriptions),i}},{key:"buildSubscription",value:function(n){var e=this;n=this.decorateObserverWithErrorHandler(n);var t=this.nativeObservable.subscribe(n),r=t.unsubscribe;return t.unsubscribe=function(){var n=e.subscriptions.findIndex(function(n){return n.subscription==t});n>=0&&(console.log("find cached subscription",e.subscriptions[0]),e.subscriptions[n].children.forEach(function(n){return n.unsubscribe()}),e.subscriptions.splice(n,1)),0==e.subscriptions.length&&console.log("unsubscribe event"),r.apply(t)},t}}]),n}();var j=function(n){var e=n.eventDomain;return n.eventType,n.eventId,E().then(function(n){return new S(function(){return n.subscribe({query:O()(D),variables:{eventDomain:e}}).map(function(n){return n.data})})}).catch(function(n){return function(n){return new S(function(){return new I.Observable(function(e){return e.error(n)})})}(n)})},x=function(n){var e=function(){var n=Object(r.useState)(),e=Object(s.a)(n,2),t=e[0],i=e[1],o=null;return{event:t,subscribe:function(n){console.log("calling subscribe"),j({eventDomain:n}).then(function(n){o=n.subscribe(function(n){console.log(n),i(n)},function(n){return console.log("error",n)},function(){return console.log("completed")})})},unsubscribe:function(){console.log("calling unsubscribe"),o&&(o.unsubscribe(),o=null)},kill:function(){console.log("calling kill"),o&&o.close()}}}(),t=(e.event,e.subscribe),o=e.unsubscribe,c=e.kill;return i.a.createElement("div",null,i.a.createElement("h1",null,"AppSync network connection testing"),i.a.createElement("div",null,i.a.createElement("button",{onClick:function(){return t("race")}},"Subscribe")),i.a.createElement("div",null,i.a.createElement("button",{onClick:o},"Unsubscribe")," "),i.a.createElement("div",null,i.a.createElement("button",{onClick:c},"  Kill connection")))},C=function(){return i.a.createElement(x,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(C,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(n){n.unregister()})},81:function(n,e){}},[[209,1,2]]]);
//# sourceMappingURL=main.5a980e9e.chunk.js.map