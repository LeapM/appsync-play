(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{106:function(n,e){},209:function(n,e,t){n.exports=t(713)},214:function(n,e,t){},215:function(n,e,t){},713:function(n,e,t){"use strict";t.r(e);var r=t(12),o=t.n(r),i=t(194),c=t.n(i),s=(t(214),t(215),t(207)),u=t(208),a=t(195),l=t(196),b=t(107),p=t.n(b),v=t(197),f=t(108),d=t.n(f),h=t(204),m="ap-southeast-2",g="https://q3ckq5u6dvds7b3pxdtswxzjii.appsync-api.ap-southeast-2.amazonaws.com/graphql",w="ap-southeast-2",E=null,k=function(){var n=Object(v.a)(p.a.mark(function n(){return p.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!E){n.next=2;break}return n.abrupt("return",E);case 2:return E=new d.a({url:g,region:m,auth:{type:f.AUTH_TYPE.AWS_IAM,credentials:new h.CognitoIdentityCredentials({IdentityPoolId:"ap-southeast-2:43d98a1a-65ef-496d-ba6d-ca788632a755"},{region:w})}}),n.abrupt("return",E);case 4:case"end":return n.stop()}},n)}));return function(){return n.apply(this,arguments)}}(),y=t(205),O=t.n(y),I="subscription OnEventDomainChange($eventDomain: String) {\n  onEventDomainChange(eventDomain: $eventDomain) {\n    id\n    eventDomain\n    eventType\n    sequence\n    eventId\n    eventKey\n    version\n    origin\n    producer\n    producerVersion\n    emitterId\n    emitterTimestamp\n    consumerTimestamp\n    created\n    data\n  }\n}\n",S=t(206),D=function(){function n(e){Object(a.a)(this,n),this.nativeObservable=void 0,this.subscriptions=[],this.creator=void 0,this.creator=e,this.nativeObservable=e()}return Object(l.a)(n,[{key:"resubscribe",value:function(){var n=this;console.log("call resubcript"),this.nativeObservable=this.creator(),this.subscriptions.forEach(function(e){return n.buildSubscription(e.observer)})}},{key:"decorateObserverWithErrorHandler",value:function(n){var e=this;return Object(u.a)({},n,{error:function(t){console.error("error happend with network"),"disconnect"===t?e.resubscribe():n.error&&n.error(t)}})}},{key:"subscribe",value:function(n,e,t){console.log("subscribe");var r=n instanceof Function?{next:n,error:e,complete:t}:n,o=this.buildSubscription(r);return this.subscriptions.push({subscription:o,children:[],observer:r}),console.log(this.subscriptions),o}},{key:"buildSubscription",value:function(n){var e=this;n=this.decorateObserverWithErrorHandler(n);var t=this.nativeObservable.subscribe(n),r=t.unsubscribe;return t.unsubscribe=function(){var n=e.subscriptions.findIndex(function(n){return n.subscription==t});n>=0&&(console.log("find cached subscription",e.subscriptions[0]),e.subscriptions[n].children.forEach(function(n){return n.unsubscribe()}),e.subscriptions.splice(n,1)),0==e.subscriptions.length&&console.log("unsubscribe event"),r.apply(t)},t}}]),n}();var j=function(n){var e=n.eventDomain;return n.eventType,n.eventId,k().then(function(n){return new D(function(){return n.subscribe({query:O()(I),variables:{eventDomain:e}}).map(function(n){return n.data})})}).catch(function(n){return function(n){return new D(function(){return new S.Observable(function(e){return e.error(n)})})}(n)})},x=null,C=function(n){var e=function(){var n=Object(r.useState)("start"),e=Object(s.a)(n,2),t=e[0],o=e[1];return console.log("initial useGraph"),Object(r.useEffect)(function(){console.log("call use effect"),console.log("calling subscribe"),j({eventDomain:"race"}).then(function(n){x=n.subscribe(function(n){console.log(n),o(n)},function(n){console.log("error",n),o("network error"+n.toString())},function(){return console.log("completed")})}),setTimeout(function(){return o("2 second passed")},2e3)},[]),{event:t,subscribe:function(n){},unsubscribe:function(){console.log("calling unsubscribe"),x&&(x.unsubscribe(),x=null)},kill:function(){console.log("not sure how to calling kill")}}}(),t=e.event,i=e.subscribe,c=e.unsubscribe,u=e.kill;return o.a.createElement("div",null,o.a.createElement("h1",null,"AppSync network connection testing"),o.a.createElement("div",null,o.a.createElement("button",{onClick:function(){return i("race")}},"Subscribe")),o.a.createElement("div",null,o.a.createElement("button",{onClick:c},"Unsubscribe")," "),o.a.createElement("div",null,o.a.createElement("button",{onClick:u},"  Kill connection")),o.a.createElement("h2",null," Event Info"),o.a.createElement("p",null,t.toString()))},T=function(){return o.a.createElement(C,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(n){n.unregister()})},81:function(n,e){}},[[209,1,2]]]);
//# sourceMappingURL=main.d6a4ea0b.chunk.js.map